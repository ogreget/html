<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdSense Eligibility Checker</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #0073e6; }
        .result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
        .eligible { color: green; }
        .not-eligible { color: red; }
    </style>
</head>
<body>
    <h1>AdSense Eligibility Checker</h1>
    <form id="checkerForm">
        <label>Masukkan URL situs Anda:</label>
        <input type="url" id="siteUrl" placeholder="https://www.contohsitus.com" required>
        <button type="button" onclick="checkEligibility()">Cek Kelayakan</button>
    </form>

    <div class="result" id="result"></div>

    <script>
        const apiKey = 'AIzaSyAm7h-4A337CSY8fehmHoRrSHMvNqTkPrE';  // API Key Anda
        const cx = '056159da4383a4a13'; // Search Engine ID Anda

        async function checkEligibility() {
            const siteUrl = document.getElementById("siteUrl").value;
            const resultDiv = document.getElementById("result");

            // Validasi URL
            if (!siteUrl) {
                resultDiv.innerHTML = "<p class='not-eligible'>Harap masukkan URL yang valid.</p>";
                return;
            }

            try {
                const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(siteUrl)}`);
                const data = await response.json();
                const pageContent = data.contents;

                // Parsing konten HTML untuk mengambil elemen
                const parser = new DOMParser();
                const doc = parser.parseFromString(pageContent, 'text/html');

                // Inisialisasi variabel pengecekan
                let eligible = true;
                let reasons = [];

                // 1. Cek keberadaan elemen <h1>
                if (!doc.querySelector('h1')) {
                    eligible = false;
                    reasons.push("Tidak ada heading utama (<h1>) pada halaman.");
                }

                // 2. Cek jumlah paragraf
                const paragraphs = Array.from(doc.querySelectorAll('p'));
                if (paragraphs.length < 10) {
                    eligible = false;
                    reasons.push("Halaman memiliki kurang dari 10 paragraf konten.");
                }

                // 3. Cek panjang konten
                const pageText = doc.body.innerText || "";
                if (pageText.length < 3000) {
                    eligible = false;
                    reasons.push("Jumlah konten halaman kurang dari 3000 karakter.");
                }

                // 4. Cek halaman 'About' dan 'Privacy Policy'
                if (!pageContent.includes("about") || !pageContent.includes("privacy")) {
                    eligible = false;
                    reasons.push("Halaman tidak memiliki 'About Us' atau 'Privacy Policy'.");
                }

                // 5. Cek navigasi sederhana (jumlah link)
                const links = doc.querySelectorAll('a');
                if (links.length < 5) {
                    eligible = false;
                    reasons.push("Navigasi halaman memiliki kurang dari 5 link.");
                }

                // 6. Cek keaslian konten menggunakan Google Custom Search API
                for (let i = 0; i < Math.min(paragraphs.length, 5); i++) {
                    const paragraph = paragraphs[i].textContent;
                    const duplicateFound = await checkDuplicateGoogle(paragraph);

                    if (duplicateFound) {
                        eligible = false;
                        reasons.push(`Konten duplikasi terdeteksi: "${paragraph.slice(0, 100)}..."`);
                        break;
                    }
                }

                // Tampilkan hasil
                if (eligible) {
                    resultDiv.innerHTML = "<p class='eligible'>Selamat! Situs Anda mungkin memenuhi syarat untuk AdSense.</p>";
                } else {
                    resultDiv.innerHTML = "<p class='not-eligible'>Maaf, situs Anda belum memenuhi syarat untuk AdSense karena:</p><ul>";
                    reasons.forEach(reason => {
                        resultDiv.innerHTML += "<li>" + reason + "</li>";
                    });
                    resultDiv.innerHTML += "</ul>";
                }

            } catch (error) {
                resultDiv.innerHTML = "<p class='not-eligible'>Gagal mengakses situs. Pastikan URL valid dan situs dapat diakses.</p>";
                console.error("Error:", error);
            }
        }

        // Fungsi untuk memeriksa duplikasi konten di Google Search
        async function checkDuplicateGoogle(text) {
            const query = encodeURIComponent(`"${text}"`);
            const url = `https://www.googleapis.com/customsearch/v1?q=${query}&key=${apiKey}&cx=${cx}`;
            
            const response = await fetch(url);
            const data = await response.json();
            
            // Periksa apakah ada hasil pencarian
            return data.items && data.items.length > 0;
        }
    </script>
</body>
</html>
